<!DOCTYPE html><html><head>    <!-- 页面meta -->    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <title>DEMO</title>    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">    <!-- 引入样式 -->    <link rel="stylesheet" href="plugins/elementui/index.css">    <link rel="stylesheet" href="plugins/font-awesome/css/font-awesome.min.css">    <link rel="stylesheet" href="css/style.css"></head><body class="hold-transition"><div id="app">    <div class="content-header">        <h1>基于springboot的web端网页分享平台</h1>    </div>    <div class="app-container">        <div class="box"><!--            头部操作按钮【注册 登录 刷新】-->            <div class="filter-container">                <el-col :span="20">                    <el-button type="primary"  class="butT" @click="getAllByPage()">主页</el-button>                    <el-button type="primary" :disabled="buttonNotVisible1" class="butT" @click="handleShare()">分享</el-button>                    <el-button type="primary" :disabled="buttonNotVisible1" class="butT" @click="personalMessage()">私信</el-button>                    <el-button type="primary" :disabled="buttonNotVisible1" class="butT" @click="searchTitleOrUser()">搜索</el-button>                    <el-button type="primary" :disabled="buttonNotVisible1" class="butT" @click="showCurrentUser()">用户</el-button>                    <el-button type="primary" :disabled="buttonNotVisible1" class="butT" @click="handleLogout()">退出</el-button>                </el-col>                <el-col :span="4">                    <el-button type="primary" :disabled="buttonNotVisible2" class="butT" @click="handleRegister()">注册</el-button>                    <el-button type="primary" :disabled="buttonNotVisible2" class="butT" @click="handleLogin()">登录</el-button>                </el-col>            </div><!--            主体信息展示-->            <el-table size="small" current-row-key="id" :data="dataList" stripe highlight-current-row>                <el-table-column type="index" align="center" label="序号" width="50"></el-table-column>                <el-table-column label="操作" align="center">                    <template slot-scope="scope">                        <el-button type="primary" :disabled="buttonNotVisible1" size="mini" @click="handleLike(scope.row)">赞同</el-button>                        <el-button type="danger" :disabled="buttonNotVisible1" size="mini" @click="handleDislike(scope.row)">反对</el-button>                    </template>                </el-table-column>                <el-table-column prop="viewObject.news.title" label="标题" align="center"></el-table-column>                <el-table-column prop="viewObject.news.likeCount" label="赞同数" align="center" width="75"></el-table-column>                <el-table-column prop="viewObject.news.commentCount" label="评论数" align="center" width="75"></el-table-column>                <el-table-column prop="viewObject.user.name" label="作者" align="center" width="100"></el-table-column>                <el-table-column label="操作" align="center" width="100">                    <template slot-scope="scope">                        <el-button type="primary" :disabled="buttonNotVisible1" size="mini" @click="handleComments(scope.row)">评论</el-button>                    </template>                </el-table-column>                <el-table-column label="操作" align="center" width="100">                    <template slot-scope="scope">                        <el-button type="success" size="mini" @click="lookOriginal(scope.row)">查看</el-button>                    </template>                </el-table-column>                <el-table-column label="操作" align="center" width="100">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="showPhoto(scope.row)">图片</el-button>                    </template>                </el-table-column>                <el-table-column prop="viewObject.news.createdDate" label="发布日期" align="center" width="200"></el-table-column>            </el-table>            <!--分页组件-->            <div class="pagination-container">                <el-pagination                        class="pagiantion"                        @size-change="handleSizeChange"                        @current-change="handleCurrentChange"                        :current-page="pagination.currentPage"                        :page-sizes="pagination.pageSizes"                        :page-size="pagination.pageSize"                        layout="total,sizes, prev, pager, next, jumper"                        :total="pagination.total">                </el-pagination>            </div>            <!-- 注册标签弹层 -->            <div class="add-form">                <el-dialog title="用户注册" :visible.sync="registerFormVisible">                    <el-form ref="dataAddForm" :model="formData" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="用户名" prop="name">                                    <el-input v-model="formData.name"/>                                </el-form-item>                            </el-col>                            <el-col :span="12">                                <el-form-item label="密码" prop="password">                                    <el-input v-model="formData.password"/>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row >                            <!--                            offset偏移量【24】-->                            <el-col :span="12" :offset="19">                                <el-switch                                        active-text="记住登录"                                        v-model="rememberme"                                        active-color="#13ce66"                                        inactive-color="#ff4949">                                </el-switch>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleRegisterRegister()">注册</el-button>                    </div>                </el-dialog>            </div>            <!-- 登录标签弹层 -->            <div class="add-form">                <el-dialog title="登录" :visible.sync="loginFormVisible">                    <el-form ref="dataEditForm" :model="formData" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="用户名" prop="name">                                    <el-input v-model="formData.name"/>                                </el-form-item>                            </el-col>                            <el-col :span="12">                                <el-form-item label="密码" prop="password">                                    <el-input v-model="formData.password"/>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row ><!--                            offset偏移量【24】-->                            <el-col :span="12" :offset="19">                                <el-switch                                        active-text="记住登录"                                        v-model="rememberme"                                        active-color="#13ce66"                                        inactive-color="#ff4949">                                </el-switch>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleLoginConfirm()">登录</el-button>                    </div>                </el-dialog>            </div><!--            分享标签弹层-->            <div class="add-form">                <el-dialog title="分享" :visible.sync="shareFormVisible">                    <el-form ref="dataShareForm" :model="shareFormDate" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="标题" prop="title">                                    <el-input v-model="shareFormDate.title"/>                                </el-form-item>                            </el-col>                            <el-col :span="12">                                <el-form-item label="链接" prop="link">                                    <el-input v-model="shareFormDate.link"/>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row >                            <el-col push="6">                                <el-upload                                        class="upload-demo"                                        ref="upload"                                        drag                                        action="/uploadImage"                                        :show-file-list="false"                                        :auto-upload="false">                                    <i class="el-icon-upload"></i>                                    <div class="el-upload__text">将文件拖到此处，或<em>点击上传</em></div>                                    <div class="el-upload__tip" slot="tip">只能上传jpg/png文件，且不超过500kb</div>                                </el-upload>                            </el-col><!--                            <el-button style="margin-left: 10px;" size="small" type="success" @click="submitUpload">上传到服务器</el-button>-->                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleShareConfirm()">发表</el-button>                    </div>                </el-dialog>            </div><!--            私信-->            <div class="add-form">                <el-dialog title="私信" :visible.sync="messageFormVisible">                    <el-form ref="dataMessageForm" :model="messageFormDate" :rules="rules" label-position="right" label-width="100px"><!--                    收到的私信list-->                        <template>                            <el-table                                    :data="messageTableData"                                    height="250"                                    border                                    style="width: 100%">                                <el-table-column                                        prop="viewObject.message.createdDate"                                        label="日期"                                        width="140">                                </el-table-column>                                <el-table-column                                        prop="viewObject.user.name"                                        label="用户"                                        width="100">                                </el-table-column>                                <el-table-column                                        prop="viewObject.message.content"                                        label="内容">                                </el-table-column>                            </el-table>                        </template>                        <el-row>                            <el-col :span="12">                                <el-form-item label="收信人" prop="toUserName">                                    <el-input v-model="messageFormDate.toUserName"/>                                </el-form-item>                            </el-col>                            <el-col :span="12">                                <el-form-item label="内容" prop="content">                                    <el-input v-model="messageFormDate.content"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleMessageConfirm()">发送</el-button>                    </div>                </el-dialog>            </div><!--            评论-->            <div class="add-form">                <el-dialog title="评论" :visible.sync="commentsFormVisible">                    <el-form ref="dataCommentsForm" :model="commentsFormDate" :rules="rules" label-position="right" label-width="100px"><!--                        显示本条news的所有评论的list-->                        <template>                            <el-table                                    :data="commentsTableData"                                    height="250"                                    border                                    style="width: 100%">                                <el-table-column                                        prop="viewObject.comment.createdDate"                                        label="日期"                                        width="100">                                </el-table-column>                                <el-table-column                                        prop="viewObject.user.name"                                        label="用户"                                        width="100">                                </el-table-column>                                <el-table-column                                        prop="viewObject.comment.content"                                        label="评论">                                </el-table-column>                            </el-table>                        </template>                        <el-row>                            <el-col :span="12">                                <el-form-item label="分享您的想法" prop="content" label-width="180"><!--                                    type="textarea"--><!--                                    <el-input v-model="commentsFormDate.comment"/>-->                                    <el-input                                            placeholder="最大30个字符"                                            v-model="commentsFormDate.content "                                            maxlength="30"                                            show-word-limit                                    >                                    </el-input>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleCommentConfirm()">发表</el-button>                    </div>                </el-dialog>            </div><!--            搜索-->            <div class="add-form">                <el-dialog title="搜索" :visible.sync="searchFormVisible">                    <el-form ref="dataSearchForm" :model="searchFormDate" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="标题" prop="title">                                    <el-input v-model="searchFormDate.title"/>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleSearchConfirm()">搜索</el-button>                    </div>                </el-dialog>            </div>        </div>    </div></div></body><!-- 引入组件库 --><script src="js/vue.js"></script><script src="plugins/elementui/index.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script src="js/axios-0.18.0.js"></script><script>    // import {axios} from "../js/axios-0.18.0";    // import {axios} from "../js/axios-0.18.0";    var vue = new Vue({        el: '#app',        data:{            buttonNotVisible1:true,//上面一排按钮的可见性【分享、私信、搜索、用户、退出、评论】            buttonNotVisible2:false,//上面一排按钮的可见性【注册、登录】            user:null,            rememberme:false,//【登录 注册中的记住我】            dataList: [],//当前页要展示的列表数据            fileList:[],//文件上传列表            shareFormVisible:false,//【分享】表单是否可见            registerFormVisible: false,//【添加】表单是否可见            commentsFormVisible:false,//【评论】表单是否可见            loginFormVisible:false,//【编辑】表单是否可见            messageFormVisible:false,//【编辑】表单是否可见            searchFormVisible:false,//【搜索】表单是否可见            formData: {},//表单数据【注册和登录表单内的数据】            shareFormDate:{},//【分享】表单数据            messageFormDate:{},//【私信】表单数据            messageTableData:[],//【私信】中收到的私信list            searchFormDate:{},            //【评论】表单中的【发表】无法获得本条news的id 通过【评论】按钮获得            //用来传递newsid            currentNewsId:null,            commentsFormDate:{},//【评论】表单数据  其实就一个comment            commentsTableData:[],//【评论】列表数据 存放评论            rules: {//校验规则                name: [{ required: true, message: '用户名为必填项', trigger: 'blur' }],                password: [{ required: true, message: '密码为必填项', trigger: 'blur' }]            },            pagination: {//分页相关模型数据                currentPage: 1,//当前页码【由前端提供】                pageSize:10,//每页显示的记录数【由前端提供】                pageSizes:[5,10,15,20],                total:0//总记录数【从后端获取】            }        },        //钩子函数，VUE对象初始化完成后自动执行        created() {            console.log("钩来！")            axios.get("/loginStatus").then(resp=>{                if(resp.data.code==1){                    //未登录                    console.log("未登录")                    this.buttonNotVisible1=true                    this.buttonNotVisible2=false                }else{                    //已登录                    console.log("已登录")                    this.buttonNotVisible1=false                    this.buttonNotVisible2=true                }            })            //调用查询全部数据的操作            this.getAllByPage()        },        methods: {            //无条件的分页查询获得所有news            getAllByPage(){                this.resetForm()//清空                this.pagination.currentPage=1                axios.post("/home/newsT/"+this.pagination.currentPage+"/"+this.pagination.pageSize,this.searchFormDate).then(resp=>{                    this.dataList=resp.data;                    this.pagination.total=resp.data[0].viewObject.totalCount;//从第一个中获取totalCount                })            },            //可能有条件的分页查询获得所有news            getAllByPageAndCondition(){                axios.post("/home/newsT/"+this.pagination.currentPage+"/"+this.pagination.pageSize,this.searchFormDate).then(resp=>{                    this.dataList=resp.data;                    this.pagination.total=resp.data[0].viewObject.totalCount;//从第一个中获取totalCount                })            },            //list中操作中【查看原文】            lookOriginal(row){                //跨域问题 第一个可以 第二个不可以                // window.open("https://www.baidu.com/")                // axios.get("https://www.baidu.com/")                window.open("/lookOriginal?id="+row.viewObject.news.id)            },            showPhoto(row){                window.open("/getImage?newsId="+row.viewObject.news.id)            },            //list中操作中【评论】            handleComments(row){                this.commentsFormDate={}                // this.resetForm()//清空                this.commentsFormVisible=true;//显示                this.currentNewsId=row.viewObject.news.id//设置当前操作的新闻【中间变量】                //传递当前操作新闻的id给后端 查询到所有评论                axios.get("/getComment/"+row.viewObject.news.id).then(resp=>{                    this.commentsTableData=resp.data;                })            },            //【评论】中的【发表】            handleCommentConfirm(){                axios.post("/addComment?newsId="+this.currentNewsId,this.commentsFormDate).then(resp=>{                    if(resp.data.code==0){                        this.$message.success(resp.data.msg)//显示成功提示                        this.commentsFormVisible=false;//关闭窗口                        this.getAllByPageAndCondition();//刷新页面                    }else{                        this.$message.error(resp.data.msg)//显示失败提示                    }                })            },            //顶栏中的【搜索】按钮            searchTitleOrUser(){                this.resetForm()//清空                this.searchFormVisible=true;//显示            },            //【搜索】中的【搜索】            handleSearchConfirm(){                console.log(this.searchFormDate.title)                console.log(this.searchFormDate)                this.pagination.currentPage=1                axios.post("/home/newsT/"+this.pagination.currentPage+"/"+this.pagination.pageSize,this.searchFormDate).then(resp=>{                    this.dataList=resp.data;                    this.pagination.total=resp.data[0].viewObject.totalCount;//从第一个中获取totalCount                })                this.searchFormVisible=false;//关闭显示                // this.resetForm()//清空            },            //顶栏中的【用户】按钮            showCurrentUser(){                axios.get("/home/user").then(resp=>{                    this.$alert(resp.data, '用户', {                        confirmButtonText: '确定',                    })                })            },            //顶栏中的【分享】按钮            handleShare(){                this.resetForm()//清空                this.shareFormVisible=true;//显示            },            //【分享】中的【发表】            handleShareConfirm(){                //先把有标题和链接的news创建出来                axios.post("/addNews",this.shareFormDate).then(resp=>{                    if(resp.data.code=="0"){                        this.$message.success(resp.data.msg)                        this.shareFormVisible=false                    }else {                        this.$message.error(resp.data.msg)                    }                    this.getAllByPageAndCondition()//刷新                })                //然后再上传图片                this.submitUpload()            },            //顶栏中的【私信】按钮            personalMessage(){                this.resetForm()//清空                this.messageFormVisible=true;//显示                axios.get("/getMessage").then(resp=>{                    this.messageTableData=resp.data;                })            },            //【私信】中的发送            handleMessageConfirm(){                // console.log(this.messageFormDate)                axios.post("/addMessage",this.messageFormDate).then(resp=>{                    if(resp.data.code=="0"){                        this.$message.success(resp.data.msg)                        // this.messageFormVisible=false;                        this.resetForm()//发送成功后清空输出框                    }else {                        this.$message.error(resp.data.msg)                    }                })            },            //重置表单【登录 注册 分享 私信】            resetForm() {                this.formData={}                this.shareFormDate={}                this.rememberme=false                this.commentsFormDate={}                this.messageFormDate={}                this.searchFormDate={}            },            //顶栏中的【退出】按钮            handleLogout(){                axios.get("/logout").then(resp=>{                    if(resp.data.code=="0"){                        //成功退出                        this.$message.success(resp.data.msg)                        this.buttonNotVisible1=true;                        this.buttonNotVisible2=false;                    }else{                        //退出失败                        this.$message.error(resp.data.msg)                    }                })            },            //顶栏中的【登录】按钮            handleLogin () {                this.resetForm()//清除                this.loginFormVisible=true;//显示            },            //登录中的【登录】按钮            handleLoginConfirm(){                axios.post("/login/?rememberme="+this.rememberme,this.formData).then(resp=>{                    if(resp.data.code=="0"){                        //登录成功                        this.loginFormVisible=false//关闭窗口                        this.$message.success(resp.data.msg)                        this.buttonNotVisible1=false;                        this.buttonNotVisible2=true;                    }else if(resp.data.code=="1") {                        this.$alert(resp.data.msg, '注意', {confirmButtonText: '确定'})                    }else {                        this.loginFormVisible=false                        this.$message.error(resp.data.msg)                    }                })            },            //顶栏中的【注册】按钮            handleRegister() {                this.resetForm()//清除                this.registerFormVisible=true;//显示            },            //注册中的【注册】按钮            handleRegisterRegister(){                axios.post("/register/?rememberme="+this.rememberme,this.formData).then(resp=>{                    if(resp.data.code=="0"){                        //注册成功                        this.registerFormVisible=false//关闭                        this.$message.success(resp.data.msg)                        this.buttonNotVisible1=false;                        this.buttonNotVisible2=true;                    }else if(resp.data.code=="1") {                        this.$alert(resp.data.msg, '注意', {confirmButtonText: '确定'})                    }else {                        this.registerFormVisible=false                        this.$message.error(resp.data.msg)                    }                })            },            //喜欢            handleLike(row){                // console.log(row.viewObject.news.id)                axios.get("/like/?id="+row.viewObject.news.id).then(resp=>{                    if(resp.data.code=="0"){                        // this.$message.success("操作成功，当前赞同"+resp.data.msg)                        this.$message.success("感谢您的赞同")                        this.getAllByPageAndCondition()                    }else {                        this.$message.error("操作失败，"+resp.data.msg)                    }                })            },            //不喜欢            handleDislike(row){                // console.log(row.viewObject.news.id)                axios.get("/dislike/?id="+row.viewObject.news.id).then(resp=>{                    if(resp.data.code=="0"){                        // this.$message.success("操作成功，当前赞同："+resp.data.msg)                        this.$message.success("感谢您的反馈")                        //刷新页面                        this.getAllByPageAndCondition()                    }else{                        this.$message.error("操作失败，"+resp.data.msg)                    }                })            },            //切换当前页码            handleCurrentChange(currentPage) {                this.pagination.currentPage=currentPage;                this.getAllByPageAndCondition()            },            //切换页码size            handleSizeChange(val){                this.pagination.pageSize=val;                this.getAllByPageAndCondition()            },            //【注册 登录 分享 评论 私信】中的取消            cancel(){                this.registerFormVisible=false                this.loginFormVisible=false                this.shareFormVisible=false                this.commentsFormVisible=false                this.messageFormVisible=false                this.searchFormVisible=false            },            submitUpload() {                this.$refs.upload.submit();            },        }    })</script></html>